#!/usr/bin/env node

console.log('running commit-wizard in folder %s', process.cwd());
var join = require('path').join;
var pkgPath = join(process.cwd(), 'package.json');
var pkg = require(pkgPath);

var wizardName = pkg.config &&
  pkg.config['pre-git'] &&
  pkg.config['pre-git'].wizard ||
  'cz-conventional-changelog';
console.log('using commit message wizard %s', wizardName);

var wizard = require(wizardName);
var inquirer = require('inquirer');

function gotCommitMessage(commitMessage) {
  var gitCommit = require('ggit').commit;
  gitCommit(commitMessage)
    .then(
      console.log.bind(console),
      console.error.bind(console))
    .done();
}

wizard.prompter(inquirer, gotCommitMessage);

